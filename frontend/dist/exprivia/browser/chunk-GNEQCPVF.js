import"./chunk-BYXBJQAS.js";import{a as he,b as be}from"./chunk-FZYR36Q4.js";import{b as ue,c as _e,d as fe}from"./chunk-HYC2QBNA.js";import{A as le,B as de,C as ce,D as me,E as pe,F as ge,o as te,p as M,r as ie,s as ne,w as oe,x as re,y as ae,z as se}from"./chunk-MUYZMUET.js";import{b as ee}from"./chunk-SI2F5UYO.js";import{a as xe}from"./chunk-P2BE77TI.js";import{a as ve}from"./chunk-RNCFMLFN.js";import{Da as u,Ga as H,H as S,Ha as d,Ia as G,Ja as E,La as U,Nb as Q,Ob as J,Pa as n,Pb as K,Qa as o,Ra as f,Tb as N,V as p,Va as h,W as g,Wb as X,X as C,Xa as _,Y as I,Ya as c,a as L,b as A,g as R,gb as l,hb as T,ib as v,jb as V,jc as Z,kb as $,lb as B,mb as F,nb as D,pb as q,qa as s,qb as Y,tb as O,ua as k,za as W}from"./chunk-CEITJAHH.js";var we=(r,t,e)=>({"bg-green-100 text-green-800":r,"bg-yellow-100 text-yellow-800":t,"bg-red-100 text-red-800":e}),Te=(r,t,e)=>({"fa-check":r,"fa-clock":t,"fa-times":e}),Ie=()=>({standalone:!0});function Ee(r,t){r&1&&(n(0,"div",13)(1,"div",14),f(2,"div",15),n(3,"p",16),l(4,"Caricamento prenotazioni..."),o()()())}function Me(r,t){if(r&1){let e=h();n(0,"button",43),_("click",function(){p(e);let a=c(2);return a.searchTerm="",g(a.applySearchFilter())}),f(1,"i",44),o()}}function Ue(r,t){if(r&1&&(n(0,"option",61),l(1),o()),r&2){let e=t.$implicit;d("value",e),s(),T(e)}}function Ve(r,t){if(r&1){let e=h();n(0,"button",62),_("click",function(){let a=p(e).$implicit,m=c(3);return g(m.onPageChange(a))}),l(1),o()}if(r&2){let e=t.$implicit,i=c(3);E("bg-blue-600",e===i.currentPage)("text-white",e===i.currentPage)("text-gray-700",e!==i.currentPage)("hover:bg-gray-100",e!==i.currentPage),s(),v(" ",e," ")}}function Be(r,t){if(r&1){let e=h();n(0,"div",45)(1,"div",46)(2,"div",47)(3,"label",48),l(4,"Mostra:"),o(),n(5,"select",49),D("ngModelChange",function(a){p(e);let m=c(2);return F(m.itemsPerPage,a)||(m.itemsPerPage=a),g(a)}),_("ngModelChange",function(a){p(e);let m=c(2);return g(m.onItemsPerPageChange(a))}),u(6,Ue,2,2,"option",50),o(),n(7,"span",51),l(8,"elementi per pagina"),o()(),n(9,"div",52),l(10),o(),n(11,"div",53)(12,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToFirstPage())}),C(),n(13,"svg",55),f(14,"path",56),o()(),I(),n(15,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToPreviousPage())}),C(),n(16,"svg",55),f(17,"path",57),o()(),u(18,Ve,2,9,"button",58),I(),n(19,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToNextPage())}),C(),n(20,"svg",55),f(21,"path",59),o()(),I(),n(22,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToLastPage())}),C(),n(23,"svg",55),f(24,"path",60),o()()()()()}if(r&2){let e=c(2);s(5),B("ngModel",e.itemsPerPage),s(),d("ngForOf",e.pageOptions),s(4),$(" Visualizzati ",e.getStartIndex(),"-",e.getEndIndex()," di ",e.totalItems," risultati "),s(2),d("disabled",e.currentPage===1),s(3),d("disabled",e.currentPage===1),s(3),d("ngForOf",e.pageNumbers),s(),d("disabled",e.currentPage===e.totalPages),s(3),d("disabled",e.currentPage===e.totalPages)}}function Fe(r,t){if(r&1&&(n(0,"div",74)(1,"span",16),l(2,"Utente:"),o(),n(3,"div",69),l(4),o()()),r&2){let e=c().$implicit;s(4),V("",e.users.nome," ",e.users.cognome,"")}}function De(r,t){if(r&1){let e=h();n(0,"div",63)(1,"div",64)(2,"div",65)(3,"div",66),l(4),o(),n(5,"div",51),l(6),o()(),n(7,"span",67),l(8),o()(),n(9,"div",68)(10,"div")(11,"span",16),l(12,"Stanza:"),o(),n(13,"div",69),l(14),o()(),n(15,"div")(16,"span",16),l(17,"Postazione:"),o(),n(18,"div",69),l(19),o()(),u(20,Fe,5,2,"div",70),o(),n(21,"div",71)(22,"button",72),_("click",function(){let a=p(e).$implicit,m=c(2);return g(m.deletePrenotazione(a))}),f(23,"i",73),l(24," Elimina "),o()()()}if(r&2){let e=t.$implicit,i=c(2);s(4),v(" ",i.formatDate(e.data_inizio,"dd/MM/yyyy")," "),s(2),v(" ",i.getFormattedTimeRange(e.data_inizio,e.data_fine)," "),s(),d("ngClass",O(8,we,e.stato_prenotazione==="Confermata",e.stato_prenotazione==="InAttesa",e.stato_prenotazione==="Annullata")),s(),v(" ",e.stato_prenotazione," "),s(6),T(e.stanze.nome),s(5),T(e.postazione.nomePostazione),s(),d("ngIf",i.isAdmin),s(2),d("disabled",i.isLoading)}}function Oe(r,t){if(r&1){let e=h();n(0,"span"),l(1," Prova a modificare i termini di ricerca o "),n(2,"button",80),_("click",function(){p(e);let a=c(3);return a.searchTerm="",g(a.applySearchFilter())}),l(3," cancella i filtri "),o()()}}function Ne(r,t){if(r&1&&(n(0,"span"),l(1),o()),r&2){let e=c(3);s(),v(" ",e.isAdmin?"Non ci sono prenotazioni nel sistema.":"Non hai ancora effettuato prenotazioni."," ")}}function Le(r,t){if(r&1){let e=h();n(0,"button",81),_("click",function(){p(e);let a=c(3);return g(a.openNewBookingModal())}),f(1,"i",25),l(2," Crea la tua prima prenotazione "),o()}}function Ae(r,t){if(r&1&&(n(0,"div",75)(1,"div",76),f(2,"i"),o(),n(3,"h3",77),l(4),o(),n(5,"p",78),u(6,Oe,4,0,"span",11)(7,Ne,2,1,"span",11),o(),u(8,Le,3,0,"button",79),o()),r&2){let e=c(2);s(2),U(e.searchTerm?"fas fa-search text-gray-400 text-xl":"fas fa-calendar-times text-gray-400 text-xl"),s(2),v(" ",e.searchTerm?"Nessun risultato trovato":"Nessuna prenotazione trovata"," "),s(2),d("ngIf",e.searchTerm),s(),d("ngIf",!e.searchTerm),s(),d("ngIf",!e.searchTerm)}}function $e(r,t){if(r&1){let e=h();n(0,"th",82)(1,"button",35),_("click",function(){p(e);let a=c(2);return g(a.sortTable("utente"))}),n(2,"span"),l(3,"Utente"),o(),f(4,"i"),o()()}if(r&2){let e=c(2);s(),E("text-blue-600",e.isSortedColumn("utente")),s(3),U(e.getSortIcon("utente"))}}function je(r,t){if(r&1&&(n(0,"td",97)(1,"div",98)(2,"div",66),l(3),o(),n(4,"div",99),l(5),o()()()),r&2){let e=c().$implicit;s(3),V(" ",e.users.nome||"N/A"," ",e.users.cognome||""," "),s(2),v(" ",e.users.email||"N/A"," ")}}function Re(r,t){if(r&1){let e=h();n(0,"tr",83)(1,"td",84)(2,"div",69),l(3),o()(),n(4,"td",85)(5,"div",66),l(6),o()(),u(7,je,6,3,"td",86),n(8,"td",85)(9,"div",87),l(10),o(),n(11,"div",88),l(12),o()(),n(13,"td",89)(14,"div",87),l(15),o(),n(16,"div",88),l(17),o()(),n(18,"td",90)(19,"span",91),f(20,"i",92),n(21,"span",93),l(22),o()()(),n(23,"td",85)(24,"button",94),_("click",function(){let a=p(e).$implicit,m=c(2);return g(m.deletePrenotazione(a))}),f(25,"i",95),n(26,"span",96),l(27,"Elimina"),o()()()()}if(r&2){let e=t.$implicit,i=c(2);s(3),T(i.formatDate(e.data_inizio,"dd/MM/yyyy")),s(3),v(" ",i.getFormattedTimeRange(e.data_inizio,e.data_fine)," "),s(),d("ngIf",i.isAdmin),s(3),v(" ",e.stanze.nome," "),s(2),v(" ",e.stanze.tipo_stanza," "),s(3),v(" ",e.postazione.nomePostazione," "),s(2),v(" ID: ",e.postazione.id_postazione," "),s(2),d("ngClass",O(11,we,e.stato_prenotazione==="Confermata",e.stato_prenotazione==="InAttesa",e.stato_prenotazione==="Annullata")),s(),d("ngClass",O(15,Te,e.stato_prenotazione==="Confermata",e.stato_prenotazione==="InAttesa",e.stato_prenotazione==="Annullata")),s(2),T(e.stato_prenotazione),s(2),d("disabled",i.isLoading)}}function We(r,t){if(r&1){let e=h();n(0,"span"),l(1," Prova a modificare i termini di ricerca o "),n(2,"button",106),_("click",function(){p(e);let a=c(3);return a.searchTerm="",g(a.applySearchFilter())}),l(3," cancella i filtri "),o()()}}function He(r,t){if(r&1&&(n(0,"span"),l(1),o()),r&2){let e=c(3);s(),v(" ",e.isAdmin?"Non ci sono prenotazioni nel sistema.":"Non hai ancora effettuato prenotazioni."," ")}}function Ge(r,t){if(r&1){let e=h();n(0,"div",107)(1,"button",81),_("click",function(){p(e);let a=c(3);return g(a.openNewBookingModal())}),f(2,"i",25),l(3," Crea la tua prima prenotazione "),o()()}}function qe(r,t){if(r&1&&(n(0,"tr")(1,"td",100)(2,"div",101)(3,"div",102),f(4,"i"),o(),n(5,"div",14)(6,"h3",103),l(7),o(),n(8,"p",104),u(9,We,4,0,"span",11)(10,He,2,1,"span",11),o()(),u(11,Ge,4,0,"div",105),o()()()),r&2){let e=c(2);s(),H("colspan",e.isAdmin?7:6),s(3),U(e.searchTerm?"fas fa-search text-gray-400 text-xl":"fas fa-calendar-times text-gray-400 text-xl"),s(3),v(" ",e.searchTerm?"Nessun risultato trovato":"Nessuna prenotazione trovata"," "),s(2),d("ngIf",e.searchTerm),s(),d("ngIf",!e.searchTerm),s(),d("ngIf",!e.searchTerm)}}function Ye(r,t){if(r&1&&(n(0,"option",61),l(1),o()),r&2){let e=t.$implicit;d("value",e),s(),T(e)}}function Qe(r,t){if(r&1){let e=h();n(0,"button",62),_("click",function(){let a=p(e).$implicit,m=c(3);return g(m.onPageChange(a))}),l(1),o()}if(r&2){let e=t.$implicit,i=c(3);E("bg-blue-600",e===i.currentPage)("text-white",e===i.currentPage)("text-gray-700",e!==i.currentPage)("hover:bg-gray-100",e!==i.currentPage),s(),v(" ",e," ")}}function Je(r,t){if(r&1){let e=h();n(0,"div",108)(1,"div",46)(2,"div",47)(3,"label",109),l(4,"Mostra:"),o(),n(5,"select",110),D("ngModelChange",function(a){p(e);let m=c(2);return F(m.itemsPerPage,a)||(m.itemsPerPage=a),g(a)}),_("ngModelChange",function(a){p(e);let m=c(2);return g(m.onItemsPerPageChange(a))}),u(6,Ye,2,2,"option",50),o(),n(7,"span",51),l(8,"elementi per pagina"),o()(),n(9,"div",52),l(10),o(),n(11,"div",53)(12,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToFirstPage())}),C(),n(13,"svg",55),f(14,"path",56),o()(),I(),n(15,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToPreviousPage())}),C(),n(16,"svg",55),f(17,"path",57),o()(),u(18,Qe,2,9,"button",58),I(),n(19,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToNextPage())}),C(),n(20,"svg",55),f(21,"path",59),o()(),I(),n(22,"button",54),_("click",function(){p(e);let a=c(2);return g(a.goToLastPage())}),C(),n(23,"svg",55),f(24,"path",60),o()()()()()}if(r&2){let e=c(2);s(5),B("ngModel",e.itemsPerPage),s(),d("ngForOf",e.pageOptions),s(4),$(" Visualizzati ",e.getStartIndex(),"-",e.getEndIndex()," di ",e.totalItems," risultati "),s(2),d("disabled",e.currentPage===1),s(3),d("disabled",e.currentPage===1),s(3),d("ngForOf",e.pageNumbers),s(),d("disabled",e.currentPage===e.totalPages),s(3),d("disabled",e.currentPage===e.totalPages)}}function Ke(r,t){if(r&1){let e=h();n(0,"div")(1,"div",17)(2,"div",18)(3,"div",19)(4,"input",20),D("ngModelChange",function(a){p(e);let m=c();return F(m.searchTerm,a)||(m.searchTerm=a),g(a)}),_("keyup",function(){p(e);let a=c();return g(a.applySearchFilter())}),o(),n(5,"div",21),u(6,Me,2,0,"button",22),f(7,"i",23),o()()(),n(8,"div",5)(9,"button",24),_("click",function(){p(e);let a=c();return g(a.openNewBookingModal())}),f(10,"i",25),l(11," Nuova Prenotazione "),o()()(),u(12,Be,25,10,"div",26),n(13,"div",27),u(14,De,25,12,"div",28)(15,Ae,9,6,"div",29),o(),n(16,"div",30)(17,"div",31)(18,"table",32)(19,"thead",33)(20,"tr")(21,"th",34)(22,"button",35),_("click",function(){p(e);let a=c();return g(a.sortTable("data_inizio"))}),n(23,"span"),l(24,"Data"),o(),f(25,"i"),o()(),n(26,"th",36)(27,"button",35),_("click",function(){p(e);let a=c();return g(a.sortTable("orario"))}),n(28,"span"),l(29,"Orario"),o(),f(30,"i"),o()(),u(31,$e,5,4,"th",37),n(32,"th",34),l(33,"Stanza"),o(),n(34,"th",38),l(35,"Postazione"),o(),n(36,"th",39),l(37,"Stato"),o(),n(38,"th",39),l(39,"Azioni"),o()()(),n(40,"tbody",40),u(41,Re,28,19,"tr",41)(42,qe,12,7,"tr",11),o()()()(),u(43,Je,25,10,"div",42),o()}if(r&2){let e=c();s(4),B("ngModel",e.searchTerm),s(2),d("ngIf",e.searchTerm),s(6),d("ngIf",e.prenotazioni.length>0),s(2),d("ngForOf",e.paginatedPrenotazioni)("ngForTrackBy",e.trackByPrenotazione),s(),d("ngIf",!(e.paginatedPrenotazioni!=null&&e.paginatedPrenotazioni.length)&&!e.isLoading),s(7),E("text-blue-600",e.isSortedColumn("data_inizio")),s(3),U(e.getSortIcon("data_inizio")),s(2),E("text-blue-600",e.isSortedColumn("orario")),s(3),U(e.getSortIcon("orario")),s(),d("ngIf",e.isAdmin),s(10),d("ngForOf",e.paginatedPrenotazioni)("ngForTrackBy",e.trackByPrenotazione),s(),d("ngIf",!(e.paginatedPrenotazioni!=null&&e.paginatedPrenotazioni.length)&&!e.isLoading),s(),d("ngIf",e.prenotazioni.length>0)}}function Xe(r,t){if(r&1){let e=h();n(0,"button",139),_("click",function(){p(e);let a=c(3);return g(a.clearUserSearch())}),f(1,"i",44),o()}}function Ze(r,t){if(r&1){let e=h();n(0,"div",142),_("click",function(){let a=p(e).$implicit,m=c(4);return g(m.selectUser(a))}),n(1,"div",66),l(2),o(),n(3,"div",51),l(4),o()()}if(r&2){let e=t.$implicit;s(2),V(" ",e.nome," ",e.cognome," "),s(2),v(" ",e.email," ")}}function et(r,t){if(r&1&&(n(0,"div",140),u(1,Ze,5,3,"div",141),o()),r&2){let e=c(3);s(),d("ngForOf",e.filteredUsers)("ngForTrackBy",e.trackByUser)}}function tt(r,t){if(r&1&&(n(0,"div",143)(1,"div",144),l(2),o()()),r&2){let e=c(3);s(2),v(' Nessun utente trovato per "',e.userSearchTerm,'" ')}}function it(r,t){r&1&&(n(0,"div",145),l(1," Seleziona un utente "),o())}function nt(r,t){if(r&1){let e=h();n(0,"div",133)(1,"label",120),l(2,"Utente"),o(),n(3,"div",133)(4,"input",134),D("ngModelChange",function(a){p(e);let m=c(2);return F(m.userSearchTerm,a)||(m.userSearchTerm=a),g(a)}),_("ngModelChange",function(){p(e);let a=c(2);return g(a.filterUsers())})("focus",function(){p(e);let a=c(2);return g(a.showUserDropdown=!0)})("blur",function(){p(e);let a=c(2);return g(a.onUserInputBlur())}),o(),n(5,"div",21),u(6,Xe,2,0,"button",135),f(7,"i",23),o()(),u(8,et,2,2,"div",136)(9,tt,3,1,"div",137),f(10,"input",138),u(11,it,2,0,"div",122),o()}if(r&2){let e,i=c(2);s(4),B("ngModel",i.userSearchTerm),d("ngModelOptions",Y(6,Ie)),s(2),d("ngIf",i.userSearchTerm),s(2),d("ngIf",i.showUserDropdown&&i.filteredUsers.length>0),s(),d("ngIf",i.showUserDropdown&&i.userSearchTerm&&i.filteredUsers.length===0),s(2),d("ngIf",((e=i.bookingForm.get("userId"))==null?null:e.invalid)&&((e=i.bookingForm.get("userId"))==null?null:e.touched))}}function ot(r,t){r&1&&(n(0,"div",145),l(1," Seleziona una data "),o())}function rt(r,t){if(r&1&&(n(0,"option",61),l(1),o()),r&2){let e=t.$implicit;d("value",e.start+" - "+e.end),s(),V(" ",e.start," - ",e.end," ")}}function at(r,t){r&1&&(n(0,"div",145),l(1," Seleziona un orario "),o())}function st(r,t){if(r&1&&(n(0,"option",61),l(1),o()),r&2){let e=t.$implicit;d("value",e),s(),v(" ",e," ")}}function lt(r,t){r&1&&(n(0,"div",145),l(1," Seleziona un tipo di stanza "),o())}function dt(r,t){if(r&1&&(n(0,"option",61),l(1),o()),r&2){let e=t.$implicit;d("value",e.id_stanza),s(),v(" ",e.nome," ")}}function ct(r,t){r&1&&(n(0,"div",145),l(1," Seleziona una stanza "),o())}function mt(r,t){if(r&1&&(n(0,"option",61),l(1),o()),r&2){let e=t.$implicit;d("value",e.id_postazione),s(),v(" ",e.nomePostazione," ")}}function pt(r,t){r&1&&(n(0,"div",145),l(1," Seleziona una postazione "),o())}function gt(r,t){if(r&1&&(n(0,"div",146)(1,"p",147),l(2),o()()),r&2){let e=c(2);s(2),T(e.modalErrorMessage)}}function ut(r,t){r&1&&(n(0,"span",148),f(1,"i",149),o())}function _t(r,t){if(r&1){let e=h();n(0,"div",111),_("click",function(){p(e);let a=c();return g(a.closeModal())}),n(1,"div",112),_("click",function(a){return p(e),g(a.stopPropagation())}),n(2,"form",113),_("ngSubmit",function(){p(e);let a=c();return g(a.onSubmitModal())}),n(3,"div",114)(4,"h3",115),f(5,"i",116),l(6," Nuova Prenotazione "),o()(),n(7,"div",117)(8,"div",118),u(9,nt,12,7,"div",119),n(10,"div")(11,"label",120),l(12,"Data"),o(),f(13,"input",121),u(14,ot,2,0,"div",122),o(),n(15,"div")(16,"label",120),l(17,"Orario"),o(),n(18,"select",123)(19,"option",124),l(20,"Seleziona orario"),o(),u(21,rt,2,3,"option",50),o(),u(22,at,2,0,"div",122),o(),n(23,"div")(24,"label",120),l(25,"Tipo Stanza"),o(),n(26,"select",125)(27,"option",124),l(28,"Seleziona tipo stanza"),o(),u(29,st,2,2,"option",50),o(),u(30,lt,2,0,"div",122),o(),n(31,"div")(32,"label",120),l(33,"Stanza"),o(),n(34,"select",126)(35,"option",124),l(36,"Seleziona stanza"),o(),u(37,dt,2,2,"option",50),o(),u(38,ct,2,0,"div",122),o(),n(39,"div")(40,"label",120),l(41,"Postazione"),o(),n(42,"select",127)(43,"option",124),l(44,"Seleziona postazione"),o(),u(45,mt,2,2,"option",50),o(),u(46,pt,2,0,"div",122),o()(),u(47,gt,3,1,"div",128),o(),n(48,"div",129)(49,"button",130),_("click",function(){p(e);let a=c();return g(a.closeModal())}),l(50," Annulla "),o(),n(51,"button",131),u(52,ut,2,0,"span",132),l(53),o()()()()()}if(r&2){let e,i,a,m,z,y,w,x=c();s(2),d("formGroup",x.bookingForm),s(7),d("ngIf",x.isAdmin),s(5),d("ngIf",((e=x.bookingForm.get("date"))==null?null:e.invalid)&&((e=x.bookingForm.get("date"))==null?null:e.touched)),s(7),d("ngForOf",x.timeSlots),s(),d("ngIf",((i=x.bookingForm.get("timeSlot"))==null?null:i.invalid)&&((i=x.bookingForm.get("timeSlot"))==null?null:i.touched)),s(7),d("ngForOf",x.tipiStanza),s(),d("ngIf",((a=x.bookingForm.get("tipoStanza"))==null?null:a.invalid)&&((a=x.bookingForm.get("tipoStanza"))==null?null:a.touched)),s(4),d("disabled",!((m=x.bookingForm.get("tipoStanza"))!=null&&m.value)),s(3),d("ngForOf",x.filteredStanze),s(),d("ngIf",((z=x.bookingForm.get("stanzaId"))==null?null:z.invalid)&&((z=x.bookingForm.get("stanzaId"))==null?null:z.touched)),s(4),d("disabled",!((y=x.bookingForm.get("stanzaId"))!=null&&y.value)),s(3),d("ngForOf",x.filteredPostazioni),s(),d("ngIf",((w=x.bookingForm.get("postazioneId"))==null?null:w.invalid)&&((w=x.bookingForm.get("postazioneId"))==null?null:w.touched)),s(),d("ngIf",x.modalErrorMessage),s(2),d("disabled",x.isModalLoading),s(2),d("disabled",x.isModalLoading||x.bookingForm.invalid),s(),d("ngIf",x.isModalLoading),s(),v(" ",x.isModalLoading?"Creazione...":"Crea Prenotazione"," ")}}var ye=class r{constructor(t,e,i,a,m,z,y,w){this.prenotazioneService=t;this.authService=e;this.toastService=i;this.datePipe=a;this.fb=m;this.adminService=z;this.stanzaService=y;this.postazioneService=w;this.bookingForm=this.fb.group({userId:[""],date:["",M.required],timeSlot:["",M.required],tipoStanza:["",M.required],stanzaId:["",M.required],postazioneId:["",M.required]})}prenotazioni=[];filteredPrenotazioni=[];paginatedPrenotazioni=[];isLoading=!1;isAdmin=!1;destroy$=new R;sortColumn="data_inizio";sortDirection="desc";searchTerm="";currentPage=1;itemsPerPage=25;totalItems=0;totalPages=0;pageOptions=[10,25,50,100];pageNumbers=[];showModal=!1;isModalLoading=!1;modalErrorMessage="";bookingForm;users=[];stanze=[];tipiStanza=[];filteredStanze=[];filteredPostazioni=[];userSearchTerm="";filteredUsers=[];showUserDropdown=!1;selectedUser=null;timeSlots=[{start:"08:00",end:"09:00"},{start:"09:00",end:"10:00"},{start:"10:00",end:"11:00"},{start:"11:00",end:"12:00"},{start:"12:00",end:"13:00"},{start:"13:00",end:"14:00"},{start:"14:00",end:"15:00"},{start:"15:00",end:"16:00"},{start:"16:00",end:"17:00"},{start:"17:00",end:"18:00"}];ngOnInit(){this.checkUserRole(),this.loadPrenotazioni(),this.loadModalData(),this.setupFormSubscriptions()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}checkUserRole(){this.authService.getIdentity().pipe(S(this.destroy$)).subscribe(t=>{this.isAdmin=t?.authorities?.includes("ROLE_ADMIN")||!1,this.isAdmin?this.bookingForm.get("userId")?.setValidators([M.required]):this.bookingForm.get("userId")?.clearValidators(),this.bookingForm.get("userId")?.updateValueAndValidity()})}loadPrenotazioni(){this.isLoading=!0,(this.isAdmin?this.prenotazioneService.getPrenotazioni():this.prenotazioneService.getMiePrenotazioni()).pipe(S(this.destroy$)).subscribe({next:e=>{this.prenotazioni=e.map(i=>A(L({},i),{data_inizio:this.parseDate(i.data_inizio),data_fine:this.parseDate(i.data_fine),stato_prenotazione:i.stato_prenotazione||"Confermata",users:{id_user:i.users?.id_user||0,nome:i.users?.nome||"N/A",cognome:i.users?.cognome||"N/A",email:i.users?.email||"N/A",enabled:i.users?.enabled||!1},postazione:{id_postazione:i.postazione?.id_postazione||0,nomePostazione:i.postazione?.nomePostazione||"N/A"},stanze:{id_stanza:i.stanze?.id_stanza||0,nome:i.stanze?.nome||"N/A",tipo_stanza:i.stanze?.tipo_stanza||"N/A"}})),this.applySorting(),this.isLoading=!1},error:e=>{console.error("Errore nel caricamento delle prenotazioni:",e);let i="Si \xE8 verificato un errore durante il caricamento delle prenotazioni";e.message?.includes("non autorizzato")?i="Non hai i permessi per accedere a queste prenotazioni":e.message?.includes("timeout")&&(i="Il caricamento sta richiedendo troppo tempo. Riprova tra poco"),this.showErrorToast("Errore di Caricamento",i),this.isLoading=!1}})}deletePrenotazione(t){if(!t.id_prenotazioni){this.showErrorToast("Errore di Sistema","Impossibile identificare la prenotazione da eliminare");return}let e=this.formatDate(t.data_inizio,"dd/MM/yyyy"),i=this.getFormattedTimeRange(t.data_inizio,t.data_fine),a=t.postazione?.nomePostazione||"N/A",m=t.stanze?.nome||"N/A";confirm(`Sei sicuro di voler eliminare la prenotazione?

\u{1F4C5} Data: ${e}
\u23F0 Orario: ${i}
\u{1F3E2} Stanza: ${m}
\u{1F4BA} Postazione: ${a}

Questa azione non pu\xF2 essere annullata.`)&&(this.isLoading=!0,this.showInfoToast("Eliminazione in corso","Stiamo cancellando la prenotazione..."),this.prenotazioneService.deletePrenotazione(t.id_prenotazioni).pipe(S(this.destroy$)).subscribe({next:()=>{this.clearAllToasts(),this.showSuccessToast("Prenotazione Cancellata",`La prenotazione del ${e} \xE8 stata eliminata con successo`),this.prenotazioni=this.prenotazioni.filter(y=>y.id_prenotazioni!==t.id_prenotazioni),this.applySorting(),this.isLoading=!1},error:y=>{console.error("Errore nell'eliminazione della prenotazione:",y),this.clearAllToasts();let w="Si \xE8 verificato un errore durante l'eliminazione della prenotazione";y.message?.includes("non trovata")?w="La prenotazione non \xE8 pi\xF9 disponibile o \xE8 gi\xE0 stata eliminata":y.message?.includes("non autorizzato")?w="Non hai i permessi per eliminare questa prenotazione":y.message?.includes("timeout")&&(w="L'operazione sta richiedendo troppo tempo. Riprova tra poco"),this.showErrorToast("Errore nell'Eliminazione",w),this.isLoading=!1}}))}parseDate(t){if(t instanceof Date)return t;if(Array.isArray(t))try{let[e,i,a,m,z]=t;return new Date(e,i-1,a,m,z)}catch(e){return console.error("Error parsing array date:",e),new Date}if(typeof t=="string"){if(t.includes(","))try{let[e,i,a,m,z]=t.split(",").map(Number);return new Date(e,i-1,a,m,z)}catch(e){return console.error("Error parsing comma-separated date:",e),new Date}try{return new Date(t)}catch(e){return console.error("Error parsing ISO date:",e),new Date}}return console.error("Unknown date format:",t),new Date}isValidDate(t){return t instanceof Date&&!isNaN(t.getTime())}formatDate(t,e){return this.isValidDate(t)&&this.datePipe.transform(t,e,"","it-IT")||"Data non valida"}getFormattedTimeRange(t,e){if(!this.isValidDate(t)||!this.isValidDate(e))return"Orario non valido";let i=this.formatDate(t,"HH:mm"),a=this.formatDate(e,"HH:mm");return`${i} - ${a}`}trackByPrenotazione(t,e){return e.id_prenotazioni||t}openNewBookingModal(){this.showModal=!0,this.modalErrorMessage="",this.bookingForm.reset(),this.clearUserSearch();let t=new Date().toISOString().split("T")[0];this.bookingForm.patchValue({date:t}),this.isAdmin&&this.users.length>0&&(this.filteredUsers=this.users)}closeModal(){this.showModal=!1,this.modalErrorMessage="",this.bookingForm.reset(),this.clearUserSearch()}filterUsers(){if(!this.userSearchTerm.trim()){this.filteredUsers=this.users,this.showUserDropdown=this.users.length>0;return}let t=this.userSearchTerm.toLowerCase();this.filteredUsers=this.users.filter(e=>`${e.nome} ${e.cognome}`.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)),this.showUserDropdown=!0}selectUser(t){this.selectedUser=t,this.userSearchTerm=`${t.nome} ${t.cognome}`,this.bookingForm.patchValue({userId:t.id_user}),this.showUserDropdown=!1}clearUserSearch(){this.userSearchTerm="",this.selectedUser=null,this.filteredUsers=[],this.showUserDropdown=!1,this.bookingForm.patchValue({userId:""})}onUserInputBlur(){setTimeout(()=>{this.showUserDropdown=!1},200)}trackByUser(t,e){return e.id_user||t}loadModalData(){this.isAdmin&&this.adminService.getAllUsers().pipe(S(this.destroy$)).subscribe({next:t=>{this.users=t,this.filteredUsers=t},error:t=>{console.error("Error loading users:",t),this.showErrorToast("Errore di Caricamento","Impossibile caricare la lista degli utenti. Riprova pi\xF9 tardi")}}),this.stanzaService.getStanzeWithPostazioni().pipe(S(this.destroy$)).subscribe({next:t=>{this.stanze=t,this.tipiStanza=[...new Set(t.map(e=>e.tipo_stanza))]},error:t=>{console.error("Error loading stanze:",t),this.showErrorToast("Errore di Caricamento","Impossibile caricare le stanze disponibili. Riprova pi\xF9 tardi")}})}setupFormSubscriptions(){this.bookingForm.get("tipoStanza")?.valueChanges.pipe(S(this.destroy$)).subscribe(t=>{t?this.filteredStanze=this.stanze.filter(e=>e.tipo_stanza===t):this.filteredStanze=[],this.bookingForm.patchValue({stanzaId:"",postazioneId:""}),this.filteredPostazioni=[]}),this.bookingForm.get("stanzaId")?.valueChanges.pipe(S(this.destroy$)).subscribe(t=>{if(t){let e=this.stanze.find(i=>i.id_stanza===+t);this.filteredPostazioni=e?.postazioni||[]}else this.filteredPostazioni=[];this.bookingForm.patchValue({postazioneId:""})})}onSubmitModal(){if(!this.bookingForm.valid){this.modalErrorMessage="Compila tutti i campi richiesti",Object.keys(this.bookingForm.controls).forEach(b=>{this.bookingForm.get(b)?.markAsTouched()}),this.showWarningToast("Campi Obbligatori","Completa tutti i campi richiesti prima di procedere");return}this.isModalLoading=!0,this.modalErrorMessage="";let t=this.bookingForm.value,e=new Date(t.date),[i,a]=t.timeSlot.split(" - ")[0].split(":"),[m,z]=t.timeSlot.split(" - ")[1].split(":"),y=new Date(e);y.setHours(parseInt(i),parseInt(a),0,0);let w=new Date(e);w.setHours(parseInt(m),parseInt(z),0,0);let x=b=>{let P=b.getFullYear(),ze=String(b.getMonth()+1).padStart(2,"0"),Se=String(b.getDate()).padStart(2,"0"),Ce=String(b.getHours()).padStart(2,"0"),ke=String(b.getMinutes()).padStart(2,"0"),Pe=String(b.getSeconds()).padStart(2,"0");return`${P}-${ze}-${Se} ${Ce}:${ke}:${Pe}`},j={id_postazione:parseInt(t.postazioneId),id_stanza:parseInt(t.stanzaId),data_inizio:x(y),data_fine:x(w)};(this.isAdmin&&t.userId?this.prenotazioneService.createPrenotazioneAdmin(A(L({},j),{id_user:parseInt(t.userId)})):this.prenotazioneService.createPrenotazione(j)).pipe(S(this.destroy$)).subscribe({next:b=>{this.clearAllToasts(),this.showSuccessToast("Prenotazione Creata",`La prenotazione per il ${this.formatDate(y,"dd/MM/yyyy")} \xE8 stata creata con successo`),this.closeModal(),this.loadPrenotazioni(),this.isModalLoading=!1},error:b=>{console.error("Error creating prenotazione:",b),this.clearAllToasts();let P="Si \xE8 verificato un errore durante la creazione della prenotazione";b.message?.includes("gi\xE0 prenotata")?P="La postazione \xE8 gi\xE0 prenotata per l'orario selezionato":b.message?.includes("non disponibile")?P="La postazione non \xE8 disponibile per l'orario selezionato":b.message?.includes("non autorizzato")?P="Non hai i permessi per creare questa prenotazione":b.message?.includes("timeout")&&(P="L'operazione sta richiedendo troppo tempo. Riprova tra poco"),this.modalErrorMessage=P,this.showErrorToast("Errore nella Creazione",P),this.isModalLoading=!1}})}updatePagination(){this.totalItems=this.filteredPrenotazioni.length,this.totalPages=Math.ceil(this.totalItems/this.itemsPerPage),this.currentPage>this.totalPages&&(this.currentPage=Math.max(1,this.totalPages));let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;this.paginatedPrenotazioni=this.filteredPrenotazioni.slice(t,e),this.generatePageNumbers()}generatePageNumbers(){this.pageNumbers=[];let e=Math.max(1,this.currentPage-Math.floor(5/2)),i=Math.min(this.totalPages,e+5-1);i-e+1<5&&(e=Math.max(1,i-5+1));for(let a=e;a<=i;a++)this.pageNumbers.push(a)}onPageChange(t){t>=1&&t<=this.totalPages&&t!==this.currentPage&&(this.currentPage=t,this.updatePagination())}onItemsPerPageChange(t){this.itemsPerPage=t,this.currentPage=1,this.updatePagination()}goToFirstPage(){this.onPageChange(1)}goToLastPage(){this.onPageChange(this.totalPages)}goToPreviousPage(){this.onPageChange(this.currentPage-1)}goToNextPage(){this.onPageChange(this.currentPage+1)}getStartIndex(){return(this.currentPage-1)*this.itemsPerPage+1}getEndIndex(){return Math.min(this.currentPage*this.itemsPerPage,this.totalItems)}sortTable(t){this.sortColumn===t?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortColumn=t,this.sortDirection="asc"),this.applySorting()}applySearchFilter(){this.applySorting()}applySorting(){let t=[...this.prenotazioni];if(this.searchTerm.trim()){let e=this.searchTerm.toLowerCase();t=t.filter(i=>`${i.users?.nome||""} ${i.users?.cognome||""}`.toLowerCase().includes(e)||(i.users?.email||"").toLowerCase().includes(e)||(i.stanze?.nome||"").toLowerCase().includes(e)||(i.stanze?.tipo_stanza||"").toLowerCase().includes(e)||(i.postazione?.nomePostazione||"").toLowerCase().includes(e)||this.formatDate(i.data_inizio,"dd/MM/yyyy").includes(e)||(i.stato_prenotazione||"").toLowerCase().includes(e))}this.filteredPrenotazioni=t.sort((e,i)=>{let a,m;switch(this.sortColumn){case"data_inizio":a=new Date(e.data_inizio),m=new Date(i.data_inizio);break;case"orario":a=new Date(e.data_inizio),m=new Date(i.data_inizio);break;case"utente":a=`${e.users?.nome||""} ${e.users?.cognome||""}`.trim().toLowerCase(),m=`${i.users?.nome||""} ${i.users?.cognome||""}`.trim().toLowerCase();break;default:return 0}return a<m?this.sortDirection==="asc"?-1:1:a>m?this.sortDirection==="asc"?1:-1:0}),this.currentPage=1,this.updatePagination()}getSortIcon(t){return this.sortColumn!==t?"fas fa-sort text-gray-400":this.sortDirection==="asc"?"fas fa-sort-up text-blue-600":"fas fa-sort-down text-blue-600"}isSortedColumn(t){return this.sortColumn===t}showSuccessToast(t,e){this.toastService.showSuccess(t,e)}showErrorToast(t,e){this.toastService.showError(t,e)}showInfoToast(t,e){this.toastService.showInfo(t,e)}showWarningToast(t,e){this.toastService.showWarning(t,e)}clearAllToasts(){this.toastService.clear()}static \u0275fac=function(e){return new(e||r)(k(ve),k(ee),k(fe),k(N),k(me),k(xe),k(be),k(he))};static \u0275cmp=W({type:r,selectors:[["app-user-bookings"]],features:[q([N])],decls:19,vars:12,consts:[[1,"max-w-7xl","mx-auto","p-4","sm:p-6"],[1,"bg-white","rounded-xl","shadow-sm","p-4","sm:p-6","mb-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"flex","items-center","space-x-4"],[1,"px-3","py-1","bg-blue-100","text-blue-800","text-sm","font-medium","rounded-full"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],[1,"fas","fa-refresh","mr-2"],[1,"bg-white","rounded-xl","shadow-sm","p-4","sm:p-6"],["class","flex justify-center items-center py-12",4,"ngIf"],[4,"ngIf"],["style","position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); z-index: 99999; display: flex; align-items: center; justify-content: center;",3,"click",4,"ngIf"],[1,"flex","justify-center","items-center","py-12"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto","mb-4"],[1,"text-gray-500"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","mb-6","space-y-4","sm:space-y-0"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","space-y-4","sm:space-y-0","sm:space-x-4","flex-1"],[1,"relative","w-full","sm:w-96"],["type","text","placeholder","Cerca per utente, stanza, postazione, data...",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2","pr-10","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","duration-200",3,"ngModelChange","keyup","ngModel"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","flex","items-center","space-x-1"],["class","text-gray-400 hover:text-gray-600 focus:outline-none","title","Cancella ricerca",3,"click",4,"ngIf"],[1,"fas","fa-search","text-gray-400"],[1,"inline-flex","items-center","px-4","py-2","bg-blue-600","text-white","text-sm","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","transition-colors","duration-200","cursor-pointer",3,"click"],[1,"fas","fa-plus","mr-2"],["class","bg-white border border-gray-200 rounded-lg p-4 mb-6",4,"ngIf"],["id","bookings-mobile",1,"block","sm:hidden","space-y-4"],["class","bg-white border border-gray-200 rounded-lg p-4 shadow-sm",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],["id","bookings-table",1,"hidden","sm:block","overflow-x-auto","border","border-gray-200","rounded-lg"],[1,"inline-block","min-w-full","align-middle"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-3","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","w-32"],["type","button",1,"flex","items-center","space-x-1","hover:text-gray-700","focus:outline-none","transition-colors","duration-200",3,"click"],[1,"px-3","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","w-24"],["class","px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48 hidden lg:table-cell",4,"ngIf"],[1,"px-3","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","w-32","hidden","md:table-cell"],[1,"px-3","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","w-20"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors duration-150",4,"ngFor","ngForOf","ngForTrackBy"],["class","bg-white border border-gray-200 rounded-lg p-4 mt-6",4,"ngIf"],["title","Cancella ricerca",1,"text-gray-400","hover:text-gray-600","focus:outline-none",3,"click"],[1,"fas","fa-times","text-sm"],[1,"bg-white","border","border-gray-200","rounded-lg","p-4","mb-6"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"flex","items-center","gap-2"],["for","itemsPerPageTop",1,"text-sm","font-medium","text-gray-700"],["id","itemsPerPageTop",1,"border","border-gray-300","rounded-md","px-3","py-1","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-700"],[1,"flex","items-center","gap-1"],[1,"p-2","text-gray-500","hover:text-gray-700","disabled:text-gray-300","disabled:cursor-not-allowed",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 19l-7-7 7-7m8 14l-7-7 7-7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],["class","px-3 py-1 mx-1 text-sm font-medium rounded-md transition-colors duration-200",3,"bg-blue-600","text-white","text-gray-700","hover:bg-gray-100","click",4,"ngFor","ngForOf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 5l7 7-7 7M5 5l7 7-7 7"],[3,"value"],[1,"px-3","py-1","mx-1","text-sm","font-medium","rounded-md","transition-colors","duration-200",3,"click"],[1,"bg-white","border","border-gray-200","rounded-lg","p-4","shadow-sm"],[1,"flex","justify-between","items-start","mb-2"],[1,"flex-1"],[1,"font-medium","text-gray-900"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"grid","grid-cols-2","gap-2","text-sm","mb-3"],[1,"font-medium"],["class","col-span-2",4,"ngIf"],[1,"flex","justify-end"],["type","button",1,"inline-flex","items-center","px-3","py-2","border","border-transparent","text-xs","font-medium","rounded","text-red-700","bg-red-100","hover:bg-red-200","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer","transition-colors","duration-200",3,"click","disabled"],[1,"fas","fa-trash","mr-1"],[1,"col-span-2"],[1,"text-center","py-12"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-gray-100","mb-4"],[1,"text-sm","font-medium","text-gray-900","mb-1"],[1,"text-sm","text-gray-500","mb-4"],["class","inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",3,"click",4,"ngIf"],[1,"text-blue-600","hover:text-blue-800","underline",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","transition-colors","duration-200",3,"click"],[1,"px-3","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","w-48","hidden","lg:table-cell"],[1,"hover:bg-gray-50","transition-colors","duration-150"],[1,"px-3","py-3","text-sm","text-gray-900"],[1,"px-3","py-3","text-sm"],["class","px-3 py-3 hidden lg:table-cell",4,"ngIf"],[1,"font-medium","text-gray-900","truncate"],[1,"text-xs","text-gray-500"],[1,"px-3","py-3","text-sm","hidden","md:table-cell"],[1,"px-3","py-3"],[1,"inline-flex","items-center","px-1.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"fas","text-xs","mr-1",3,"ngClass"],[1,"hidden","sm:inline"],["type","button","title","Elimina prenotazione",1,"inline-flex","items-center","p-1.5","border","border-transparent","text-xs","font-medium","rounded","text-red-700","bg-red-100","hover:bg-red-200","focus:outline-none","focus:ring-1","focus:ring-red-500","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer","transition-colors","duration-200",3,"click","disabled"],[1,"fas","fa-trash","text-xs"],[1,"ml-1","hidden","sm:inline"],[1,"px-3","py-3","hidden","lg:table-cell"],[1,"text-sm"],[1,"text-xs","text-gray-500","truncate","max-w-[200px]"],[1,"px-3","py-12","text-center"],[1,"flex","flex-col","items-center","justify-center","space-y-4"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-gray-100"],[1,"text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],["class","mt-4",4,"ngIf"],[1,"text-blue-600","hover:text-blue-800","underline","cursor-pointer",3,"click"],[1,"mt-4"],[1,"bg-white","border","border-gray-200","rounded-lg","p-4","mt-6"],["for","itemsPerPage",1,"text-sm","font-medium","text-gray-700"],["id","itemsPerPage",1,"border","border-gray-300","rounded-md","px-3","py-1","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],[2,"position","fixed","top","0","left","0","width","100%","height","100%","background","rgba(0,0,0,0.3)","z-index","99999","display","flex","align-items","center","justify-content","center",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","overflow-hidden","border","border-gray-300","w-full","max-w-lg","mx-4",3,"click"],[3,"ngSubmit","formGroup"],[1,"px-6","py-4","bg-blue-50","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900","flex","items-center"],[1,"fas","fa-calendar-plus","text-blue-600","mr-2"],[1,"px-6","py-4","max-h-96","overflow-y-auto"],[1,"space-y-4"],["class","relative",4,"ngIf"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","date","formControlName","date",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["class","text-sm text-red-600 mt-1",4,"ngIf"],["formControlName","timeSlot",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["value",""],["formControlName","tipoStanza",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","stanzaId",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","disabled:bg-gray-100",3,"disabled"],["formControlName","postazioneId",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","disabled:bg-gray-100",3,"disabled"],["class","mt-4 p-3 bg-red-50 border border-red-200 rounded-md",4,"ngIf"],[1,"px-6","py-4","bg-gray-50","border-t","border-gray-200","flex","justify-end","space-x-3"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","cursor-pointer",3,"click","disabled"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],["class","mr-2",4,"ngIf"],[1,"relative"],["type","text","placeholder","Cerca utente per nome, cognome o email...",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2","pr-10","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","focus","blur","ngModel","ngModelOptions"],["type","button","class","text-gray-400 hover:text-gray-600 focus:outline-none","title","Cancella ricerca",3,"click",4,"ngIf"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",4,"ngIf"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-3",4,"ngIf"],["type","hidden","formControlName","userId"],["type","button","title","Cancella ricerca",1,"text-gray-400","hover:text-gray-600","focus:outline-none",3,"click"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-300","rounded-md","shadow-lg","max-h-60","overflow-y-auto"],["class","px-3 py-2 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"px-3","py-2","hover:bg-blue-50","cursor-pointer","border-b","border-gray-100","last:border-b-0",3,"click"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-300","rounded-md","shadow-lg","p-3"],[1,"text-sm","text-gray-500","text-center"],[1,"text-sm","text-red-600","mt-1"],[1,"mt-4","p-3","bg-red-50","border","border-red-200","rounded-md"],[1,"text-sm","text-red-600"],[1,"mr-2"],[1,"fas","fa-spinner","fa-spin"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),l(5),o(),n(6,"p",4),l(7),o()(),n(8,"div",5)(9,"span",6),l(10),o(),n(11,"button",7),_("click",function(){return i.loadPrenotazioni()}),f(12,"i",8),l(13," Aggiorna "),o()()()(),n(14,"div",9),u(15,Ee,5,0,"div",10)(16,Ke,44,19,"div",11),o()(),u(17,_t,54,18,"div",12),f(18,"p-toast")),e&2&&(G("visibility",(i.showModal,"visible")),s(5),v(" ",i.isAdmin?"Tutte le Prenotazioni":"Le tue Prenotazioni"," "),s(2),v(" ",i.isAdmin?"Visualizza e gestisci tutte le prenotazioni del sistema":"Visualizza e gestisci le tue prenotazioni"," "),s(3),V(" ",i.filteredPrenotazioni.length||0,"",i.searchTerm?" di "+(i.prenotazioni.length||0):""," prenotazioni "),s(),d("disabled",i.isLoading),s(),E("fa-spin",i.isLoading),s(3),d("ngIf",i.isLoading&&i.prenotazioni.length===0),s(),d("ngIf",!i.isLoading||i.prenotazioni.length>0),s(),d("ngIf",i.showModal))},dependencies:[X,Q,J,K,Z,ge,re,de,ce,te,le,ie,ne,ae,se,pe,oe,_e,ue],styles:["[_nghost-%COMP%]     .p-toast{z-index:9999}[_nghost-%COMP%]     .p-toast .p-toast-message{margin:0 0 .5rem;box-shadow:0 10px 25px -5px #0000001a,0 10px 10px -5px #0000000a;border-radius:.75rem;border:none;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);animation:_ngcontent-%COMP%_slideInRight .3s ease-out;min-width:320px;max-width:420px;background:#fffffff2;transform-origin:right center}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-leave{animation:_ngcontent-%COMP%_slideOutRight .25s ease-in forwards!important;overflow:hidden!important}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-leave, [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-leave *, [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-leave *:before, [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-leave *:after{transform:none!important;transition:none!important;animation:none!important}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-leave{animation:_ngcontent-%COMP%_slideOutRight .25s ease-in forwards!important}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-success{border-left:4px solid #10b981}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-success .p-toast-message-icon{color:#10b981;background:#dcfce7;border-radius:50%;width:2rem;height:2rem;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-error{border-left:4px solid #ef4444}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-error .p-toast-message-icon{color:#ef4444;background:#fee2e2;border-radius:50%;width:2rem;height:2rem;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-info{border-left:4px solid #3b82f6}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-info .p-toast-message-icon{color:#3b82f6;background:#dbeafe;border-radius:50%;width:2rem;height:2rem;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-warn{border-left:4px solid #f59e0b}[_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-warn .p-toast-message-icon{color:#f59e0b;background:#fef3c7;border-radius:50%;width:2rem;height:2rem;display:flex;align-items:center;justify-content:center;margin-right:.75rem;flex-shrink:0}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-message-icon{margin-right:.75rem;flex-shrink:0}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-message-text{flex:1;min-width:0}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_slideOutRight{0%{transform:translate(0);opacity:1}to{transform:translate(100%);opacity:0}}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-message-content{padding:1rem;border:none;border-radius:.75rem;background:transparent;display:flex;align-items:flex-start;gap:.75rem}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-summary{font-weight:500;color:#111827;font-size:.875rem;margin-bottom:.25rem;line-height:1.4}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-detail{color:#6b7280;font-size:.875rem;line-height:1.5;word-wrap:break-word}[_nghost-%COMP%]     .p-toast-top-right{top:1rem;right:1rem}[_nghost-%COMP%]     .p-toast .p-toast-message:hover{transform:translateY(-1px);transition:transform .2s ease}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-icon-close{color:#9ca3af;background:transparent;border:none;padding:.375rem;border-radius:.5rem;transition:all .2s ease}[_nghost-%COMP%]     .p-toast .p-toast-message .p-toast-icon-close:hover{color:#4b5563;background:#f3f4f6}"]})};export{ye as UserBookingsComponent};
